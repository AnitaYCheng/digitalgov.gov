{{ $path := "" }}{{ with .File }}{{ $path = .Path }}{{ else }}{{ $path = .Path }}{{ end }}

{{/*  Unique ID to link article to its title in screen readers  */}}
{{ $titleID := (printf "%s%s" "title-" .Title) | urlize }}
{{ $now := now.Format "2006-01-02" }}
{{ $start := .Date.Format "2006-01-02"  }}
{{ $eventDate := cond (ge $start $now) true false }}

<article
  class="card card-event {{ if $eventDate }}card-event-promo{{ else }}card-event-past{{ end }} card-linked"
  data-edit-this="{{- $path -}}"
  {{ if .Params.short_url }}data-short_url="{{- .Params.short_url -}}"{{ end }}
  aria-labelledby="{{ $titleID }}"
>
  <div class="card__content">
    <div class="card__header">
      <h2 class="card__header-title" id="{{ $titleID }}">
        <a href="{{ .Permalink }}" title="{{ .Title | markdownify }}" rel="bookmark">{{ .Title | markdownify }}</a>
      </h2>
    </div>

    <div class="card__body">
      {{- if .Params.summary -}}
      <div class="card__body-summary">{{ .Params.summary | markdownify -}}</div>
      {{- else -}}
      <div class="card__body-deck">{{ .Params.deck | markdownify -}}</div>
      {{- end -}}

      {{- partial "core/get_authors_short.html" . -}}
      {{- if .Params.kicker -}}
      <div class="flex-align-end card__body-kicker">
        <span>{{- .Params.kicker -}}</span>
      </div>
      {{- else -}}
        {{- if .Params.youtube_id -}}
        <div class="card__body-kicker">Video</div>
        {{- end -}}
      {{- end -}}
    </div>
  </div>

  <div class="card__date">
    <div class="card__date-past">
      <div class="card__date-desktop">
        <span class="card__date-month">{{- dateFormat "Jan" .Date -}}</span>
        <span class="card__date-day">{{- dateFormat "02" .Date -}}</span>
        <span class="card__date-label">
          Previous Event
        </span>
      </div>
      <div class="card__date-mobile">
        <span class="card__date-label">
          Previous Event
        </span>
        <span class="card__date-month">{{ dateFormat "Jan" .Date }}</span>
        <span class="card__date-day">{{ dateFormat "02" .Date }}</span>
      </div>
    </div>
  </div>
</article>
